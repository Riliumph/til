# 公開鍵暗号のたとえ

## 一般人向けのたとえ話

一般人に向けたたとえ話で好例なのは「南京錠」であろう。  
用語の対応は以下だ。

- 公開鍵：南京錠
- 秘密鍵：南京錠のカギ

公開鍵で暗号化するとはすなわち、南京錠を掛けることになる。  
そして、秘密鍵で復号することは、南京錠のカギでその南京錠を開錠することに当たる。

逆に、電子署名とはこの行いを逆にしている。  
秘密鍵で暗号化して、公開鍵で復号する。

ただし、秘密鍵、つまり南京錠のカギでカギをすることは実際にはできないのでイメージにはならない欠点を持つたとえ話ではある。

## 技術者向けのたとえ話

技術者向けに、もう少し数式を用いた例を挙げようと思う。

- 公開鍵：`f(x) = x^2 mod n`
- 秘密鍵：`f^-1`。つまり、実際に代入した`x`に相当する。

公開鍵が、**一方向関数**であることがキモである。
つまり、計算はできるが、元を探すのは難しいという特徴を持つ関数だ。

`f(x) = x^2 mod 33`

この「関数fは、x二乗を33で割った余りを求める」関数だが、この計算は難しくない。  

- `x=2`の場合、`f(x) = 4 / 33 = 0 ... 4`
- `x=3`の場合、`f(x) = 9 / 33 = 0 ... 9`

ただし、余り４となる秘密鍵`x`を求めるのは非常に難しい。  
たとえば、以下のようなケースも余り４となる。

- `x=13`の場合、`f(x) = 169 / 33 = 5 ... 4`
- `x=20`の場合、`f(x) = 400 / 33 = 12 ... 4`
- `x=31`の場合、`f(x) = 961 / 33 = 29 ... 4`

実際、モジュロの計算をすれば答えは出るが、そのためには素因数分解が必要になる。  
素因数分解は、非常に難しいという性質を使っている。
