# ID Required

主キーに`ID`とだけ振っている不親切なカラムを必ず用意するテーブル設計のこと。  
別にキーが`ID`だからダメというわけではなく、考えなしに主キーを入れておけばいいんだろっていう考えがダメという話。

## IDカラムついて

そもそも、IDカラムとは「そのシステムで一意を保証する機能」である。  
某プロジェクトでは、「外部製品のシリアルナンバーをIDにしたいのでID項目はstring型でお願いします。」とか言われたが論外である。  
トヨタ社のパーツとホンダ社のパーツが同じシリアルナンバーだった場合、どう管理するつもりなのか。  

なんども繰り返すが、「IDとは、そのシステムで一意を保証する機能」である。  
別に番号である必要は無いが、「お前が管理するんだよ」という話である。  
どこまで外注して中抜きチューチュースキーム作ろうとしてるんだ。  
少しは管理責任を持て。

## 採用される理由

たとえば、交差テーブルを考えてみる。  
Userテーブルとgroupテーブルがあるとしよう。

|user_id|user_name|age|
|:--:|:--|:--|
|1|Alice|10|
|2|Bob|11|

|group_id|group_name|authority_lv|
|:--:|:--|:--|
|1|Administrator|1|
|2|PowerUser|2|

さて、このテーブルでユーザーが何のグループに属しているかを設計する。  
今回は交差テーブルとして`membership`というテーブルを構築することで実現してみよう。

|membership_id|user_id|group_id|
|:--:|:--:|:--:|
|1|1|1|
|2|1|2|
|3|2|2|

Aliceは`Administrator`にも`PowerUser`にも属していて、Bobは`PowerUser`に属していることが表現できる。  
この時、Userテーブルの`user_id`が`id`だったらどうだろう？  
Groupテーブルの`group_id`が`id`だったらどうだろう？  

カラム名`id`がバッティングしてしまう。  
もちろん、この交差テーブルでだけUserテーブルの`id`を`user_id`とすることだってできる。  
しかし、それではあっちのSQLでは`id`でアクセスし、こっちのSQLでは`user_id`となってしまう。  
それで問題ないと思うのならば、それでいい。  
ただし、`user_id`にアクセスしているSQLを検索してgrepしたいときには困るだろう。

> ポイント  
> この関係性を交差テーブルを使わずに実現しようとした人はいないか？  
> たとえば、「Userテーブルに`group_id`を持たせる」など  
>
> |user_id|user_name|age|group_id|
> |:--:|:--:|:--:|:--:|
> |1|Alice|10|1|
> |2|Bob|11|2|
>
> 別に持たせてもいいが、**複数のグループに属する場合はどういう表現になるだろうか**？  
> まさか、アンチパターンであるJ walkを使うんじゃないだろうね？  
>
> |user_id|user_name|age|group_id|
> |:--:|:--:|:--:|:--:|
> |1|Alice|10|**1,2**（J walkはアンチパターン）|
> |2|Bob|11|2|
